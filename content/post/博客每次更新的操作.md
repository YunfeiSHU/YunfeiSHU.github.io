+++
date = '2025-09-05T20:20:00+08:00'
draft = true
title = '博客每次更新的操作'
tags = ['hugo-blog']
+++
**日常写作 & 发布（每次更新都这么做）**：

1. 在 **main** 分支编辑/新增文章（例如）

```bash
hugo new post/hello-paper-mod.md
# 编辑 content/posts/hello-paper-mod.md，把 draft 改成 false
```

2. 提交源码变更（仍在项目根目录）

```bash
git add .
git commit -m "post: hello paper mod"
git push
```

3. 生成并发布到 `doc`（worktree 的 `public/`）

```bash
hugo
cd public
git add -A
git commit -m "publish: $(Get-Date -Format 'yyyy-MM-dd HH:mm:ss')"
git push
cd ..
```

完成！网页就会更新啦 🎉

------

**一键发布脚本**：

在项目根目录新建 `deploy.ps1`：

```bash
param(
  [string]$Message = "publish: $(Get-Date -Format 'yyyy-MM-dd HH:mm:ss')"
)

# 1) 提交 main 的源码
git add .
git commit -m "content: $Message" 2>$null
git push

# 2) 确保 public 绑定了 doc（首次已做过；若未做过则自动绑定）
if (-not (Test-Path -Path ".git\worktrees\public")) {
  if (Test-Path -Path "public") { Remove-Item -Recurse -Force .\public }
  git worktree add -B doc public
}

# 3) 构建 & 发布到 doc
hugo
Push-Location public
git add -A
git commit -m $Message 2>$null
git push
Pop-Location

Write-Host "✅ Deployed to 'doc' branch."
```

以后只需：

```bash
.\deploy.ps1 -Message "update post: xxxxx"
```